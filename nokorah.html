<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nokorah - Astoria</title>
    <link rel="icon" type="image/x-icon" href="assets/images/ALICE_ACADEMIA.ico">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/nokorah.css">
    <script src="js/tailwind-config.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        @layer base {
            html { @apply scroll-smooth; }
            body { @apply antialiased; }
            a, button, [role="button"] { @apply transition-colors duration-200 ease-out; }
            input, select, textarea { @apply transition-shadow duration-200 ease-out; }
            a:focus-visible, button:focus-visible, [role="button"]:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible { @apply outline-none ring-2 ring-astoria-400 ring-offset-2 ring-offset-white; }
        }
    
        @layer utilities {
            .fade-in {
                @apply opacity-0 translate-y-2;
                animation: fadeIn 0.6s ease forwards;
            }
        }
        @keyframes fadeIn {
            to { opacity: 1; transform: translateY(0); }
        }

                        @layer components {
            .tw-surface { @apply shadow-soft ring-1 ring-black/5; }
            .tw-surface-strong { @apply shadow-soft ring-2 ring-astoria-200/60; }
            .tw-press { @apply transition-transform duration-200 ease-out active:scale-[0.98]; }
            .tw-hover { @apply transition-transform duration-200 ease-out hover:-translate-y-0.5; }
            .tw-panel { @apply rounded-2xl bg-white/80 backdrop-blur-md border border-white/70 shadow-soft; }
            .tw-card { @apply rounded-2xl bg-white/90 border border-astoria-200/60 shadow-soft; }
            .tw-card-hover { @apply transition-transform duration-200 ease-out hover:-translate-y-1; }
            .tw-btn { @apply inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 font-semibold shadow-soft bg-gradient-to-br from-astoria-400 to-astoria-600 text-white; }
            .tw-btn-ghost { @apply rounded-full border border-astoria-200/70 bg-white/80 text-astoria-600; }
            .tw-input { @apply rounded-xl border border-astoria-200/60 bg-white/90 px-4 py-2 text-sm font-semibold text-gray-700 focus:ring-2 focus:ring-astoria-400/40; }
            .tw-pill { @apply inline-flex items-center gap-1 rounded-full bg-white/70 border border-astoria-200/60 px-3 py-1 text-xs font-semibold text-astoria-600; }
            .tw-back { @apply inline-flex items-center gap-2 rounded-full border border-astoria-200/70 bg-white/80 text-astoria-600 px-4 py-2 font-semibold shadow-soft; }
        }
</style>
</head>
<body class="nokorah-theme min-h-screen">
    <main class="nokorah-page fade-in">
        <header class="nokorah-header tw-panel">
            <div>
                <a class="nokorah-back tw-back tw-press" href="profil.html" title="Retour au profil">← Retour</a>
                <h1 class="nokorah-title">Nokorah</h1>
            </div>
            <div class="character-summary" aria-label="Résumé du personnage">
                <div class="character-avatar-wrapper">
                    <div class="character-avatar character-avatar--clickable" role="button" tabindex="0" aria-haspopup="true" aria-label="Changer de personnage">
                        <img class="character-avatar-img" id="characterSummaryAvatar" alt="Avatar" hidden>
                        <div class="character-avatar-circle" id="characterSummaryInitial" hidden></div>
                    </div>
                    <div class="character-dropdown" hidden aria-label="Sélectionner un personnage"></div>
                </div>
                <div class="character-summary-text">
                    <a class="character-name" id="characterSummaryName" href="profil.html">Nom du personnage</a>
                    <span class="character-tagline" id="characterSummaryTagline">Classe / Rôle / Surnom</span>
                </div>
            </div>
        </header>
        <section class="nokorah-hero">
            <div class="nokorah-hero-card tw-surface tw-panel tw-hover">
                <span class="nokorah-hero-tag">✨ Nouveauté : Compagnons Nokorah</span>
                <h2 class="nokorah-section-title">Un esprit doux, un style unique</h2>
                <p class="nokorah-lore">
                    Les Nokorah sont de petits esprits spirituels nés des émotions positives. Ils veillent sur
                    leur porteur, partagent une énergie apaisante et s'expriment par des regards ronds et
                    des gestes mignons. Leur force dépend de leur rareté, mais leur personnalité vient de toi.
                </p>
            </div>
            <div class="nokorah-hero-art">
                <img src="assets/nokorah/hero-nokorah.svg" alt="Illustration Nokorah">
                <p class="nokorah-lore">Un seul Nokorah actif à la fois.</p>
            </div>
        </section>
        <section class="nokorah-section">
            <h2 class="nokorah-section-title">Mon Nokorah</h2>
            <div class="nokorah-manager" data-nokorah-root="main"></div>
        </section>
        <section class="nokorah-section">
            <h2 class="nokorah-section-title">Règles principales</h2>
            <div class="rules-grid">
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>1 Nokorah max</h4>
                    <p>Un seul Nokorah actif à la fois, impossible de cumuler plusieurs esprits.</p>
                </div>
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>Invocation</h4>
                    <p>Invoquer un Nokorah consomme 25 Lucky Soul. La rareté initiale est Commun.</p>
                </div>
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>Abandon</h4>
                    <p>Changer nécessite 100 Lucky Soul et une scène d'adieux obligatoire.</p>
                </div>
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>Bonus cumulés</h4>
                    <p>Les bonus de rareté se cumulent. Les points sont distribués sur les compétences existantes.</p>
                </div>
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>Accessoire</h4>
                    <p>Certains Nokorah sont accessoires : aucun effet en combat (tag visible).</p>
                </div>
                <div class="rule-card tw-surface tw-panel tw-hover">
                    <h4>Améliorations</h4>
                    <p>Les stats évoluent via une roulette aléatoire, avec un coût qui grimpe fortement.</p>
                </div>
            </div>
        </section>
        <section class="nokorah-section">
            <h2 class="nokorah-section-title">Coûts d'évolution de rareté</h2>
            <table class="cost-table" aria-label="Coûts de rareté">
                <thead>
                    <tr>
                        <th>Passage</th>
                        <th>Coût Lucky Soul</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Commun → Rare</td>
                        <td>45</td>
                    </tr>
                    <tr>
                        <td>Rare → &Eacute;pique</td>
                        <td>60</td>
                    </tr>
                    <tr>
                        <td>&Eacute;pique → Mythique</td>
                        <td>100</td>
                    </tr>
                    <tr>
                        <td>Mythique → Légendaire</td>
                        <td>150</td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section class="nokorah-section">
            <h2 class="nokorah-section-title">Aperçu des raretés</h2>
            <div class="rarity-preview-grid">
                <div class="rarity-preview-card tw-surface tw-hover">
                    <div class="rarity-frame rarity-commun">
                        <img src="assets/nokorah/silhouette-1.svg" alt="Nokorah commun">
                    </div>
                    <span class="rarity-badge rarity-commun rarity-mini">Commun</span>
                </div>
                <div class="rarity-preview-card tw-surface tw-hover">
                    <div class="rarity-frame rarity-rare">
                        <img src="assets/nokorah/silhouette-2.svg" alt="Nokorah rare">
                    </div>
                    <span class="rarity-badge rarity-rare rarity-mini">Rare</span>
                </div>
                <div class="rarity-preview-card tw-surface tw-hover">
                    <div class="rarity-frame rarity-epique">
                        <img src="assets/nokorah/silhouette-3.svg" alt="Nokorah épique">
                    </div>
                    <span class="rarity-badge rarity-epique rarity-mini">&Eacute;pique</span>
                </div>
                <div class="rarity-preview-card tw-surface tw-hover">
                    <div class="rarity-frame rarity-mythique">
                        <img src="assets/nokorah/silhouette-4.svg" alt="Nokorah mythique">
                    </div>
                    <span class="rarity-badge rarity-mythique rarity-mini">Mythique</span>
                </div>
                <div class="rarity-preview-card tw-surface tw-hover">
                    <div class="rarity-frame rarity-legendaire">
                        <img src="assets/nokorah/silhouette-5.svg" alt="Nokorah légendaire">
                    </div>
                    <span class="rarity-badge rarity-legendaire rarity-mini">Légendaire</span>
                </div>
            </div>
        </section>
    </main>
    <!-- Modals -->
    <div class="modal tw-surface" id="invokeModal">
        <div class="modal-content tw-surface">
            <h3>Invoquer un Nokorah</h3>
            <input type="text" id="nokorahName" placeholder="Nom du Nokorah" maxlength="24">
            <p style="font-size: 0.85rem; color: #666; margin: 0.5rem 0;">Choisissez une apparence (style Cookie Run):</p>
            <div class="appearance-grid" id="appearanceGrid"></div>
            <label style="font-size: 0.85rem; color: #666;">Ou téléverser (optionnel)</label>
            <input type="file" id="appearanceUpload" accept="image/*">
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button class="btn btn-secondary tw-press" id="invokeCancelBtn" style="width: auto;">Annuler</button>
                <button class="btn btn-primary tw-press" id="invokeConfirmBtn">Confirmer <span>25 LS</span></button>
            </div>
        </div>
    </div>
    <div class="modal tw-surface" id="farewellModal">
        <div class="modal-content tw-surface">
            <h3>Scène d'adieux</h3>
            <p style="font-size: 0.85rem; color: #666;">Explique pourquoi tu abandonnes ton Nokorah (min 80 caractères):</p>
            <textarea id="farewellText" placeholder="&Eacute;cris un message sinc&egrave;re..."></textarea>
            <p style="font-size: 0.85rem; color: #666;" id="farewellCount">0 / 80</p>
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button class="btn btn-secondary tw-press" id="farewellCancelBtn" style="width: auto;">Annuler</button>
                <button class="btn btn-danger tw-press" id="farewellConfirmBtn">Abandonner <span>100 LS</span></button>
            </div>
        </div>
    </div>
    <div class="modal tw-surface" id="appearanceModal">
        <div class="modal-content tw-surface">
            <h3>Changer l'apparence</h3>
            <p style="font-size: 0.85rem; color: #666; margin: 0.5rem 0;">Choisissez une apparence (style Cookie Run):</p>
            <div class="appearance-grid" id="appearanceEditGrid"></div>
            <label style="font-size: 0.85rem; color: #666;">Ou téléverser (optionnel)</label>
            <input type="file" id="appearanceEditUpload" accept="image/*">
            <div style="display: flex; gap: 0.75rem; margin-top: 1.5rem;">
                <button class="btn btn-secondary tw-press" id="appearanceCancelBtn" style="width: auto;">Annuler</button>
                <button class="btn btn-primary tw-press" id="appearanceConfirmBtn">Confirmer</button>
            </div>
        </div>
    </div>
    <script src="js/image-helpers.js"></script>
    <script src="js/data.js"></script>
    <script type="module" src="js/ui/app-shell.js"></script>
    <script type="module">
        import { initCharacterSummary } from './js/ui/character-summary.js';
        document.addEventListener('DOMContentLoaded', async () => {
            await initCharacterSummary({ enableDropdown: true, showKaels: true });
        });
    </script>
    <script type="module" src="js/nokorah.js"></script>
    <script src="js/sidebar.js"></script>
</body>
</html>
