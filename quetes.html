<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau des qu&#234;tes - Astoria</title>
    <link rel="icon" type="image/x-icon" href="assets/images/ALICE_ACADEMIA.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Yeseva+One&display=swap">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/quetes.css">
</head>
<body class="quest-board min-h-screen">
    <main class="quest-page fade-in">
        <header class="quest-header tw-panel">
            <a class="quest-back tw-back tw-press" href="profil.html" title="Retour au profil">&#8592; Retour</a>
            <div class="quest-title-wrap">
                <span class="quest-title-kicker">Astoria</span>
                <h1 class="quest-title">Tableau des qu&#234;tes</h1>
            </div>
            <div class="quest-header-right">
                <div class="character-summary" aria-label="Resume du personnage">
                    <div class="character-avatar-wrapper">
                        <div class="character-avatar character-avatar--clickable" role="button" tabindex="0" aria-haspopup="true" aria-label="Changer de personnage">
                            <img class="character-avatar-img" id="characterSummaryAvatar" alt="Avatar" hidden>
                            <div class="character-avatar-circle" id="characterSummaryInitial" hidden></div>
                        </div>
                        <div class="character-dropdown" hidden aria-label="Selectionner un personnage"></div>
                    </div>
                    <div class="character-summary-text">
                        <a class="character-name" id="characterSummaryName" href="profil.html">Nom du personnage</a>
                        <span class="character-tagline" id="characterSummaryTagline">Classe / Role / Surnom</span>
                        <div class="character-summary-meta">
                            <span class="stats-badge" id="characterKaelsBadge" hidden>0 kaels</span>
                        </div>
                    </div>
                </div>
                <button class="quest-add-btn tw-btn tw-press" id="questAddBtn" type="button" data-admin-only>+ Ajouter</button>
            </div>
        </header>
        <div class="quest-divider" aria-hidden="true">
            <span class="quest-divider-moon">&#9790;</span>
        </div>
        <section class="quest-search" aria-label="Recherche de qu&#234;tes">
            <div class="quest-search-panel tw-panel tw-surface">
                <div class="quest-search-title">Recherche</div>
                <div class="quest-search-controls">
                    <label class="quest-filter">
                        <span class="quest-filter-label">Type</span>
                        <select id="questTypeFilter" class="quest-filter-select">
                            <option value="all">Toutes cat&#233;gories</option>
                        </select>
                    </label>
                    <label class="quest-filter">
                        <span class="quest-filter-label">Rang</span>
                        <select id="questRankFilter" class="quest-filter-select">
                            <option value="all">Tous les rangs</option>
                        </select>
                    </label>
                    <div class="inventory-search" id="questSearch">
                        <button type="button" class="inventory-search-toggle tw-press" id="questSearchToggle" aria-label="Rechercher" aria-expanded="false">
                            <span class="inventory-search-icon">&#128269;</span>
                        </button>
                        <input id="questSearchInput" type="search" class="inventory-search-input" placeholder="Rechercher une qu&#234;te..." aria-label="Rechercher une qu&#234;te">
                        <button type="button" class="inventory-search-clear tw-press" id="questSearchClear" aria-label="Effacer la recherche" hidden>x</button>
                        <div class="recent-searches-dropdown inventory-search-history" id="questSearchHistory"></div>
                    </div>
                </div>
            </div>
        </section>
        <div class="quest-quickbar">
            <a class="quest-quick-btn tw-btn-ghost" href="#questHistory">Historique</a>
        </div>
        <section class="quest-carousel" aria-label="Liste des qu&#234;tes">
            <button class="quest-arrow quest-arrow--left tw-btn-ghost tw-press" id="questPrevBtn" type="button" aria-label="Qu&#234;tes pr&#233;c&#233;dentes">&#10094;</button>
            <div class="quest-carousel-viewport tw-panel" id="questViewport">
                <div class="quest-track" id="questTrack" aria-live="polite" tabindex="0"></div>
            </div>
            <button class="quest-arrow quest-arrow--right tw-btn-ghost tw-press" id="questNextBtn" type="button" aria-label="Qu&#234;tes suivantes">&#10095;</button>
        </section>
        <section class="quest-history tw-panel" id="questHistory" aria-label="Historique des qu&#234;tes">
            <div class="quest-history-tabs" role="tablist" aria-label="Navigation qu&#234;tes">
                <button class="quest-history-tab tw-press" type="button" role="tab" aria-selected="false">Qu&#234;tes</button>
                <button class="quest-history-tab active tw-press" type="button" role="tab" aria-selected="true">Historique</button>
            </div>
            <div class="quest-history-header">
                <h2>Historique</h2>
                <div class="quest-history-subtitle">Les qu&#234;tes valid&#233;es apparaissent ici.</div>
            </div>
            <div class="quest-history-body">
                <aside class="quest-history-filters tw-panel" aria-label="Categories">
                    <div class="quest-history-filters-title">Cat&#233;gories</div>
                    <div class="quest-history-filter-list" id="questHistoryFilters"></div>
                </aside>
                <div class="quest-history-table">
                    <div class="quest-history-meta" id="questHistoryMeta">0 Qu&#234;tes ex&#233;cut&#233;es</div>
                    <div class="quest-history-title">Mes transactions</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Type</th>
                                <th>Rang</th>
                                <th>Nom</th>
                                <th>Gains</th>
                            </tr>
                        </thead>
                        <tbody id="questHistoryBody"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>
    <div class="quest-modal tw-surface" id="questDetailModal" aria-hidden="true">
        <div class="quest-modal-scrim tw-surface" data-close="true"></div>
        <div class="quest-modal-card tw-panel tw-surface tw-hover" role="dialog" aria-modal="true" aria-labelledby="questDetailTitle">
            <button class="quest-modal-close tw-press" type="button" data-close="true" aria-label="Fermer">&times;</button>
            <div class="quest-modal-nav tw-surface">
                <button class="quest-modal-arrow tw-press" id="questDetailPrev" type="button" aria-label="Qu&#234;te pr&#233;c&#233;dente">&#10094;</button>
                <button class="quest-modal-arrow tw-press" id="questDetailNext" type="button" aria-label="Qu&#234;te suivante">&#10095;</button>
            </div>
            <div class="quest-modal-content tw-surface">
                <aside class="quest-modal-panel quest-modal-panel--rewards tw-panel tw-surface">
                    <h4>R&#233;compenses :</h4>
                    <ul id="questDetailRewards"></ul>
                </aside>
                <div class="quest-modal-center tw-panel tw-surface">
                    <div class="quest-modal-top tw-surface">
                        <span class="quest-modal-type" id="questDetailType"></span>
                        <h3 class="quest-modal-title" id="questDetailTitle">Qu&#234;te</h3>
                        <span class="quest-rank-badge" id="questDetailRank">F</span>
                        <span class="quest-status-badge" id="questDetailStatus">Disponible</span>
                    </div>
                    <div class="quest-modal-media">
                        <div class="quest-media-frame">
                            <button class="quest-media-arrow tw-press" id="questMediaPrev" type="button" aria-label="Image precedente">&#10094;</button>
                            <img id="questMediaImage" alt="Illustration de qu&#234;te">
                            <button class="quest-media-arrow tw-press" id="questMediaNext" type="button" aria-label="Image suivante">&#10095;</button>
                        </div>
                        <div class="quest-media-dots" id="questMediaDots"></div>
                    </div>
                    <div class="quest-info-block tw-surface">
                        <h4>Description :</h4>
                        <p id="questDetailDescription"></p>
                    </div>
                </div>
                <aside class="quest-modal-panel quest-modal-panel--side tw-panel tw-surface">
                    <div class="quest-info-block tw-surface">
                        <h4>Lieu(x) :</h4>
                        <ul id="questDetailLocations"></ul>
                    </div>
                    <div class="quest-modal-participants tw-surface">
                        <div class="quest-participants-header">
                            <h4>Participants :</h4>
                            <span id="questDetailParticipantsCount">(0/0)</span>
                        </div>
                        <ul id="questDetailParticipants"></ul>
                        <div class="quest-participants-note" id="questDetailNote"></div>
                    </div>
                </aside>
            </div>
            <div class="quest-modal-actions">
                <button class="quest-action-btn tw-btn tw-press" id="questJoinBtn" type="button">Participer</button>
                <button class="quest-action-btn quest-action-btn--ghost tw-press tw-btn-ghost" id="questEditBtn" type="button" data-admin-only>Modifier</button>
            </div>
        </div>
    </div>
    <div class="quest-modal quest-modal--editor tw-surface" id="questEditorModal" aria-hidden="true">
        <div class="quest-modal-scrim tw-surface" data-close="true"></div>
        <div class="quest-modal-card tw-panel quest-editor-card tw-surface tw-hover" role="dialog" aria-modal="true" aria-labelledby="questEditorTitle">
            <button class="quest-modal-close tw-press" type="button" data-close="true" aria-label="Fermer">&times;</button>
            <h3 class="quest-modal-title" id="questEditorTitle">Cr&#233;ation de Qu&#234;tes</h3>
            <form id="questEditorForm" class="quest-editor-form">
                <div class="quest-editor-layout">
                    <div class="quest-editor-column quest-editor-column--left">
                        <label class="quest-editor-field">
                            <span>Nom de qu&#234;te</span>
                            <input id="questNameInput" type="text" required>
                        </label>
                        <label class="quest-editor-field">
                            <span>Type de qu&#234;te</span>
                            <select id="questTypeInput" required></select>
                        </label>
                        <label class="quest-editor-field">
                            <span>Rang de difficult&#233;</span>
                            <select id="questRankInput" required></select>
                        </label>
                        <label class="quest-editor-field quest-editor-field--hidden">
                            <span>Acc&#232;s</span>
                            <select id="questStatusInput">
                                <option value="available">Disponible</option>
                                <option value="in_progress">En cours</option>
                                <option value="locked">Acces restreint</option>
                            </select>
                        </label>
                        <div class="quest-editor-block quest-editor-block--rewards tw-panel tw-surface">
    <h4>R&#233;compenses</h4>
    <div class="quest-editor-row">
        <div class="quest-reward-picker" id="questRewardPicker">
            <button class="quest-reward-trigger tw-press" id="questRewardTrigger" type="button" aria-haspopup="listbox" aria-expanded="false">
                S&#233;lectionner un objet
            </button>
            <div class="quest-reward-popover" id="questRewardPopover" role="listbox" aria-label="Objets de r&#233;compense" hidden>
                <div class="quest-reward-options" id="questRewardOptions"></div>
                <div class="quest-reward-tooltip" id="questRewardTooltip" aria-live="polite"></div>
            </div>
            <input type="hidden" id="questRewardSelect" value="">
        </div>
        <input id="questRewardQtyInput" type="number" min="1" value="1" aria-label="Quantit&#233; de r&#233;compense">
        <button id="questAddRewardBtn" type="button" class="tw-press">+</button>
    </div>
    <div class="quest-reward-preview" id="questRewardPreview"></div>
    <div class="quest-editor-list" id="questRewardsList"></div>
    <div class="quest-editor-hint">Relier &#224; l'inventaire au moment de l'int&#233;gration.</div>
</div>
                        <label class="quest-editor-field">
                            <span>Participation (1-5)</span>
                            <input id="questMaxParticipantsInput" type="number" min="1" max="5" value="5">
                        </label>
                        <label class="quest-editor-field quest-editor-field--inline">
                            <span>R&#233;p&#233;tition</span>
                            <input id="questRepeatableInput" type="checkbox">
                        </label>
                        <label class="quest-editor-field quest-editor-field--wide">
                            <span>Lieu(x) (s&#233;par&#233;s par des virgules)</span>
                            <input id="questLocationsInput" type="text" placeholder="For&#234;t d'Aeris, Ruines de Nox">
                        </label>
                    </div>
                    <div class="quest-editor-column quest-editor-column--right">
                        <div class="quest-editor-block quest-editor-block--images tw-panel">
                            <h4>Image</h4>
                            <div class="quest-editor-image-row">
                                <div class="quest-editor-image-preview">Image</div>
                                <div class="quest-editor-image-controls">
                                    <button id="questAddImageBtn" type="button" class="tw-press">Importer l'image</button>
                                    <div class="quest-editor-image-note">Recadre en carr&#233; pour garder la taille.</div>
                                </div>
                            </div>
                            <input id="questImageUrlInput" class="quest-editor-image-url" type="url" placeholder="URL de l'image">
                            <input id="questImageFileInput" type="file" accept="image/*">
                            <div class="quest-editor-list" id="questImagesList"></div>
                        </div>
                        <label class="quest-editor-field quest-editor-field--wide">
                            <span>Description</span>
                            <textarea id="questDescriptionInput" rows="4"></textarea>
                        </label>
                    </div>
                </div>
                <div class="quest-editor-actions">
                    <button class="quest-action-btn quest-action-btn--ghost tw-press tw-btn-ghost" type="button" data-close="true">Annuler</button>
                    <button class="quest-action-btn tw-btn tw-press" type="submit">Enregistrer</button>
                </div>
            </form>
            <div class="quest-editor-side" aria-label="Contr&#244;le d'&#233;tat de qu&#234;te">
                <div class="quest-editor-status">
                    <button class="quest-editor-status-dot tw-press" type="button" data-status="available" aria-label="Disponible"></button>
                    <button class="quest-editor-status-dot tw-press" type="button" data-status="in_progress" aria-label="En cours"></button>
                    <button class="quest-editor-status-dot tw-press" type="button" data-status="locked" aria-label="Acces restreint"></button>
                </div>
                <button class="quest-editor-action quest-editor-action--confirm tw-press" type="submit" form="questEditorForm" aria-label="Enregistrer">&#10003;</button>
                <button class="quest-editor-action quest-editor-action--cancel tw-press" type="button" data-close="true" aria-label="Annuler">&#10005;</button>
                <button class="quest-editor-validate tw-press" id="questValidateBtn" type="button" data-admin-only>Validation des participations</button>
            </div>
        </div>
    </div>
    <div class="quest-cropper-backdrop" id="questCropperBackdrop" aria-hidden="true">
        <div class="quest-cropper-modal tw-surface" role="dialog" aria-modal="true" aria-labelledby="questCropperTitle">
            <div class="quest-cropper-header">
                <h2 class="quest-cropper-title" id="questCropperTitle">Recadrer l'image</h2>
                <button type="button" class="quest-cropper-close tw-press" id="questCropperClose" aria-label="Fermer">x</button>
            </div>
            <div class="quest-cropper-body">
                <div class="quest-cropper-stage">
                    <img id="questCropperImage" alt="Aper&#231;u recadrage">
                </div>
                <div class="quest-cropper-controls">
                    <label for="questCropperZoom">Zoom</label>
                    <input type="range" id="questCropperZoom" min="0.2" max="3" step="0.01" value="1">
                    <p class="quest-cropper-hint">Glisse pour ajuster le cadrage carr&#233;.</p>
                </div>
            </div>
            <div class="quest-cropper-actions">
                <button type="button" class="quest-cropper-button secondary tw-press" id="questCropperCancel">Annuler</button>
                <button type="button" class="quest-cropper-button tw-press" id="questCropperConfirm">Appliquer</button>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.js"></script>
    <script src="js/data.js"></script>
    <script src="js/ui/searchbar.js"></script>
    <script type="module" src="js/quetes.js"></script>
    <script src="js/sidebar.js"></script>
</body>
</html>
