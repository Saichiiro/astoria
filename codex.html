<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="max-age=604800, public">
    <title>Liste d'objets</title>
    <link rel="icon" type="image/x-icon" href="assets/images/ALICE_ACADEMIA.ico">
    <link rel="stylesheet" href="css/style.css?v=202601291">
    <link rel="stylesheet" href="css/codex.css?v=202601291">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.css">
    <!-- Preload handled dynamically once data.js is available -->
</head>
<body class="min-h-screen">
    <main class="wrapper" aria-labelledby="pageTitle">
        <header class="page-header">
            <a href="inventaire.html" class="page-back" title="Retour √† l'inventaire">‚Üê Retour</a>
            <div class="page-header-main">
                <div class="page-title-block">
                    <h1 class="page-title" id="pageTitle">Liste d'objets</h1>
                </div>
                <div class="character-summary" aria-label="R√©sum√© du personnage">
                    <div class="character-avatar-wrapper">
                        <div class="character-avatar character-avatar--clickable" role="button" tabindex="0" aria-haspopup="true" aria-label="Changer de personnage">
                            <img class="character-avatar-img" id="characterSummaryAvatar" alt="Avatar" hidden>
                            <div class="character-avatar-circle" id="characterSummaryInitial" hidden></div>
                        </div>
                        <div class="character-dropdown" hidden aria-label="S√©lectionner un personnage"></div>
                    </div>
                    <div class="character-summary-text">
                        <a class="character-name" id="characterSummaryName" href="profil.html">Nom du personnage</a>
                        <span class="character-tagline" id="characterSummaryTagline">Classe / Role / Surnom</span>
                        <div class="character-summary-meta">
                            <span class="stats-badge" id="characterKaelsBadge" hidden>0 kaels</span>
                            <div class="character-souls" id="characterSouls" hidden>
                                <span class="soul-count" title="√Çmes consommation"><span class="soul-icon">üî•</span><span id="soulConsoValue">0</span></span>
                                <span class="soul-count" title="√Çmes progression"><span class="soul-icon">‚≠ê</span><span id="soulProgValue">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="codex-toolbar">
            <span class="stats-badge" id="statsBadge">0 objet</span>
            <button type="button" class="admin-add-btn tw-press" id="adminAddItemBtn" hidden>+ Ajouter un objet</button>
            <select id="categoryFilter" class="category-dropdown tw-input">
                <option value="">Toutes cat√©gories</option>
                <option value="agricole">&#x1F33E; Agricole</option>
                <option value="consommable">&#x1F9EA; Consommables</option>
                <option value="equipement">&#x2694;&#xFE0F; &Eacute;quipements</option>
                <option value="materiau">&#x2692;&#xFE0F; Mat√©riaux</option>
                <option value="quete">&#x2728; Qu√™tes</option>
            </select>
            <div class="inventory-search" id="codexSearch">
                <button type="button" class="inventory-search-toggle tw-press" id="codexSearchToggle" aria-label="Rechercher" aria-expanded="false">
                    <span class="inventory-search-icon">&#x1F50D;</span>
                </button>
                <input
                    type="search"
                    id="searchInput"
                    class="inventory-search-input tw-input"
                    placeholder="Rechercher un objet..."
                    aria-label="Rechercher un objet">
                <div class="recent-searches-dropdown inventory-search-history" id="recentSearchesDropdown"></div>
            </div>
        </div>
        <div class="filter-chips" id="filterChips"></div>
        <div class="table-container tw-panel">
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th scope="col">Illustration</th>
                        <th scope="col" class="sortable name-column" aria-sort="none" data-sort="name">Nom <span class="sort-indicator"></span></th>
                        <th scope="col">Description</th>
                        <th scope="col" class="sortable" aria-sort="none" data-sort="price">Commerce <span class="sort-indicator"></span></th>
                        <th scope="col">Effet (consommation)</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </main>
    <!-- Modal pour voir un item en grand / d√©tails -->
    <div
        id="itemModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="modalName"
        aria-describedby="modalDescription"
    >
        <div class="modal-inner">
            <div class="modal-header">
                <h2 class="modal-title" id="modalName"></h2>
                <div class="modal-admin-actions" id="modalAdminActions" hidden>
                    <button type="button" class="admin-edit-btn tw-press" id="adminEditBtn">Modifier</button>
                </div>
                <button class="modal-close tw-press" aria-label="Fermer la fen√™tre">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-media">
                    <div class="modal-carousel" id="modalCarousel">
                        <button class="carousel-btn prev tw-press" id="carouselPrev" aria-label="Image pr√©c√©dente">‚Äπ</button>
                        <img id="modalImage" alt="">
                        <button class="carousel-btn next tw-press" id="carouselNext" aria-label="Image suivante">‚Ä∫</button>
                    </div>
                    <div class="carousel-dots" id="carouselDots"></div>
                </div>
                <div class="modal-text">
                    <p id="modalCategory"></p>
                    <p id="modalDescription"></p>
                    <p id="modalPrice"></p>
                    <p id="modalModifiers"></p>
                    <p id="modalEffect"></p>
                </div>
            </div>
        </div>
    </div>
    <div class="codex-admin-backdrop" id="adminItemBackdrop" aria-hidden="true">
        <div class="codex-admin-modal" role="dialog" aria-modal="true" aria-labelledby="adminItemTitle">
            <div class="codex-admin-header">
                <h2 class="codex-admin-title" id="adminItemTitle">Ajouter un objet</h2>
                <button type="button" class="codex-admin-close tw-press" id="adminItemClose" aria-label="Fermer">x</button>
            </div>
            <div class="codex-admin-error" id="adminItemError" role="alert"></div>
            <div class="codex-admin-note" id="adminItemNote"></div>
            <form id="adminItemForm">
                <div class="codex-admin-section">
                    <div class="codex-admin-section-title">Infos</div>
                    <div class="codex-admin-grid">
                        <div class="codex-admin-field">
                            <label class="codex-admin-label" for="adminItemName">Nom</label>
                            <input class="codex-admin-input tw-input" id="adminItemName" name="name" required>
                        </div>
                        <div class="codex-admin-field">
                            <label class="codex-admin-label" for="adminItemCategory">Categorie</label>
                            <select class="codex-admin-input tw-input" id="adminItemCategory" name="category">
                                <option value="">Choisir une categorie</option>
                            </select>
                        </div>
                        <div class="codex-admin-field">
                            <label class="codex-admin-label" for="adminItemBuy">Prix achat</label>
                            <input class="codex-admin-input tw-input" id="adminItemBuy" name="buy" placeholder="ex: 5 po">
                        </div>
                        <div class="codex-admin-field">
                            <label class="codex-admin-label" for="adminItemSell">Prix vente</label>
                            <input class="codex-admin-input tw-input" id="adminItemSell" name="sell" placeholder="ex: 2 po">
                        </div>
                    </div>
                </div>
                <div class="codex-admin-section">
                    <div class="codex-admin-section-title">Description</div>
                    <textarea class="codex-admin-textarea tw-input" id="adminItemDescription" name="description" rows="3" placeholder="Description courte..."></textarea>
                </div>
                <div class="codex-admin-section">
                    <div class="codex-admin-section-title">Effet</div>
                    <textarea class="codex-admin-textarea tw-input" id="adminItemEffect" name="effect" rows="2" placeholder="Effet principal..."></textarea>
                </div>
                <div class="codex-admin-section">
                    <div class="codex-admin-section-title">Image</div>
                    <div class="codex-admin-image">
                        <div class="codex-admin-image-preview" id="adminItemImagePreview">
                            <span class="codex-admin-image-placeholder">Image</span>
                            <img id="adminItemImage" alt="Apercu image" hidden>
                        </div>
                        <div class="codex-admin-image-actions">
                            <button type="button" class="codex-admin-button secondary tw-press" id="adminItemImageBtn">Importer l'image</button>
                            <span class="codex-admin-image-hint">Recadre en carre pour garder la taille.</span>
                        </div>
                        <div class="codex-admin-image-meta" id="adminItemImageMeta">Aucun fichier</div>
                        <input type="file" id="adminItemImageInput" accept="image/*" hidden>
                    </div>
                </div>
                <div class="codex-admin-actions">
                    <button type="button" class="codex-admin-button danger tw-press" id="adminItemDelete" hidden>üóëÔ∏è Supprimer</button>
                    <div class="codex-admin-actions-group">
                        <button type="button" class="codex-admin-button secondary tw-press" id="adminItemCancel">Annuler</button>
                        <button type="submit" class="codex-admin-button tw-press" id="adminItemSave">Enregistrer</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="codex-cropper-backdrop" id="itemCropperBackdrop" aria-hidden="true">
        <div class="codex-cropper-modal" role="dialog" aria-modal="true" aria-labelledby="itemCropperTitle">
            <div class="codex-cropper-header">
                <h2 class="codex-cropper-title" id="itemCropperTitle">Recadrer l'image</h2>
                <button type="button" class="codex-cropper-close tw-press" id="itemCropperClose" aria-label="Fermer">x</button>
            </div>
            <div class="codex-cropper-body">
                <div class="codex-cropper-stage">
                    <img id="itemCropperImage" alt="Apercu recadrage">
                </div>
                <div class="codex-cropper-controls">
                    <label for="itemCropperZoom">Zoom</label>
                    <input type="range" id="itemCropperZoom" min="0.2" max="3" step="0.01" value="1">
                    <span class="codex-cropper-hint">Molette pour zoomer.</span>
                </div>
            </div>
            <div class="codex-cropper-actions">
                <button type="button" class="codex-admin-button secondary tw-press" id="itemCropperCancel">Annuler</button>
                <button type="button" class="codex-admin-button tw-press" id="itemCropperConfirm">Appliquer</button>
            </div>
        </div>
    </div>
    <!-- Delete confirmation modal -->
    <div class="codex-delete-backdrop" id="deleteItemBackdrop" aria-hidden="true">
        <div class="codex-delete-modal" role="dialog" aria-modal="true" aria-labelledby="deleteItemTitle">
            <div class="codex-delete-header">
                <h2 class="codex-delete-title" id="deleteItemTitle">Supprimer l'objet</h2>
            </div>
            <div class="codex-delete-body">
                <p>Voulez-vous vraiment supprimer <strong id="deleteItemName"></strong> ?</p>
                <p class="codex-delete-warning">Cette action est irr√©versible.</p>
            </div>
            <div class="codex-delete-actions">
                <button type="button" class="codex-admin-button secondary tw-press" id="deleteItemCancel">Annuler</button>
                <button type="button" class="codex-admin-button danger tw-press" id="deleteItemConfirm">Supprimer</button>
            </div>
        </div>
    </div>
    <!-- Donn√©es des objets -->
    <script src="js/image-helpers.js"></script>
    <script src="js/data.js"></script>
    <script src="js/item-modifiers.js"></script>
    <script src="js/ui/list-helpers.js"></script>
    <script src="js/ui/search-history.js"></script>
    <script src="js/ui/searchbar.js"></script>
    <script type="module" src="js/ui/app-shell.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.6.1/dist/cropper.min.js"></script>
    <script src="js/codex.js?v=202601291"></script>
    <script type="module" src="js/codex-admin-summary.js?v=202601291"></script>
    <script type="module" src="js/codex-admin.js?v=202601291"></script>
    <script src="js/sidebar.js?v=202601291"></script>
</body>
</html>
